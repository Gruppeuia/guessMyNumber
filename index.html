<!DOCTYPE HTML>
<html>
    <head>
        <title>Guess my number!</title>
        <meta charset="utf-8">
    </head>
    <body>
        
        <section>
            <h1 id="instructionTitle">Title</h1>
            <h4 id="instructionSubtitle">Description</h4>
        </section>
        
        <section>
            <label for="guess">Guess:</label>
            <input type="number" id="guessedNumber">
            <button id="guessButton" onclick="onGuessNumber()">Guess</button>
        </section>
        
        <script>
        
            const resources = {
                lang:{
                    guess_my_number_title:"Guess my number its between ${0} and ${1}",
                    correct_guess:"Your guess was correct. WOHO!!",
                    wrong_guess:"Nope thats wrong, my number is ${0}",
                    is_higher:"higher",
                    is_lower:"lower" 
                }
                
            }
            
            /*const resources = {
                lang:{
                    guess_my_number_title:"Gjett mitt tall, det er mellom ${0} og ${1}"
                }
                
            }*/
        
        </script>
        
        <script>
            
            /*
            // KIDS DONT DO THIS AT HOME !!!
            let source = "Guess my number its between ${0} and ${1}"
            
            let test = "{0}";
            let counter = 0;
            while(true){
                if(source.includes(test)){
                    source = source.replace(test,"Jupp");
                    counter++
                    test = "{"+counter+"}";
                } else{
                    break;
                }
            }
            */
            
            
            const DEBUG = true;
            const MAX_NUMBER = 100;
            const MIN_NUMBER = 1;
            
            let correctNumber = getRandomNumber();
            
            print(`The correct number is ${correctNumber}`);
        setText("instructionTitle",replace(resources.lang.guess_my_number_title,MIN_NUMBER,MAX_NUMBER));
            
            
            function onGuessNumber(){
                
                let guessedNumber = document.getElementById("guessedNumber").value * 1;
                print(`Guessed number ${guessedNumber}`);
                
                let tilteText = "";
                
                if(guessedNumber === correctNumber){
                    print("Correct guess");
                    tilteText = resources.lang.correct_guess;
                } else{
                    print("Wrong guess")  ; 
                    let diffText = (correctNumber - guessedNumber) > 0 ? resources.lang.is_higher:resources.lang.is_lower; 
                    tilteText = replace(resources.lang.wrong_guess, diffText);
                }
                
                 setText("instructionTitle",tilteText);
            }
            
            // UTIL functions -------------------------------------
            
            function setText(target, text){
                 document.getElementById(target).innerHTML = text;
            }
            
            function replace(source, ...params) {
              const regex = /\$\{\d+\}/g;
              let matches = null;
              let index = 0;

              while ((matches = regex.exec(source)) !== null) {
                if (matches.index === regex.lastIndex) {
                  regex.lastIndex++;
                }

                matches.forEach((match, groupIndex) => {
                    source = source.replace(match, params[index]);
                  index++;
                });
              }

              return source;
            }
            
            function getRandomNumber(){
                return MIN_NUMBER + Math.round(Math.random() * (MAX_NUMBER - MIN_NUMBER));
            }
            
            // DEBUG functions ----------------------------------
            
            function print(...lines){
                if(DEBUG){
                    lines.forEach(item => {
                        console.log(item);
                    })
                }
            }
            
            
        </script>
    </body>
</html>